<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal do Aluno - Fala Alunos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Main Layout */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .sidebar h3 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
            text-decoration: none;
            color: #6c757d;
        }

        .menu-item:hover,
        .menu-item.active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            transform: translateX(5px);
        }

        .menu-item i {
            width: 20px;
            text-align: center;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(39, 174, 96, 0.1);
            border-radius: 10px;
            color: #27ae60;
            font-size: 0.9rem;
        }

        .status-indicator i {
            font-size: 0.7rem;
        }

        /* Content Area */
        .content-area {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .content-section {
            display: none;
            padding: 2rem;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        .section-header h2 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .section-header p {
            color: #6c757d;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .action-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            color: white;
        }

        .action-card i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .action-card h3 {
            margin-bottom: 0.5rem;
        }

        .action-card p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        /* Chat Interface */
        .chat-container {
            height: 600px;
            display: grid;
            grid-template-columns: 300px 1fr;
            border: 1px solid #e9ecef;
            border-radius: 15px;
            overflow: hidden;
        }

        .chat-sidebar {
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .chat-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .chat-sidebar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .chat-sidebar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .chat-sidebar::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .chat-sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e9ecef;
        }

        .chat-categories {
            flex: 1;
            padding: 1rem 0;
            overflow-y: auto;
            max-height: calc(600px - 120px);
        }

        .chat-category {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .chat-category:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .chat-category.active {
            background: rgba(102, 126, 234, 0.15);
            border-left-color: #667eea;
        }

        .category-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .category-info h4 {
            color: #2c3e50;
            margin-bottom: 0.2rem;
            font-size: 0.9rem;
        }

        .category-info p {
            color: #6c757d;
            font-size: 0.8rem;
        }

        .coordinator-status {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            margin-top: 0.2rem;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .status-dot.online {
            background: #27ae60;
        }

        .status-dot.away {
            background: #f39c12;
        }

        /* Chat Main */
        .chat-main {
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e9ecef;
            background: white;
        }

        .chat-contact-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .contact-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .contact-details h4 {
            color: #2c3e50;
            margin-bottom: 0.2rem;
        }

        .contact-status {
            color: #6c757d;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: #f8f9fa;
            max-height: 400px;
            scroll-behavior: smooth;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #5a6fd8;
        }

        .message {
            display: flex;
            margin-bottom: 1rem;
            gap: 0.5rem;
        }

        .message.sent {
            justify-content: flex-end;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .message-content {
            max-width: 70%;
        }

        .message-bubble {
            padding: 0.8rem 1rem;
            border-radius: 18px;
            margin-bottom: 0.2rem;
            word-wrap: break-word;
        }

        .message.received .message-bubble {
            background: white;
            color: #2c3e50;
            border-bottom-left-radius: 4px;
        }

        .message.sent .message-bubble {
            background: #667eea;
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 0.7rem;
            color: #adb5bd;
            padding: 0 0.5rem;
        }

        .message.sent .message-time {
            text-align: right;
        }

        .chat-input-container {
            border-top: 1px solid #e9ecef;
            background: white;
        }

        .chat-input {
            display: flex;
            align-items: center;
            padding: 1rem;
            gap: 0.5rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.8rem 1rem;
            border: 1px solid #e9ecef;
            border-radius: 25px;
            outline: none;
            font-size: 0.9rem;
        }

        .chat-input input:focus {
            border-color: #667eea;
        }

        .send-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: #667eea;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .send-btn:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        /* Info Cards */
        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .info-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .info-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .info-card h4 {
            color: #2c3e50;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .info-card h4 i {
            color: #667eea;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .info-list li:last-child {
            border-bottom: none;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .sidebar {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                padding: 0 1rem;
            }

            .main-container {
                padding: 1rem;
            }

            .chat-container {
                grid-template-columns: 1fr;
                height: 500px;
            }

            .chat-sidebar {
                display: none;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content-section.active {
            animation: fadeIn 0.5s ease;
        }

        /* ========== KANBAN STYLES ========== */
        .kanban-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .kanban-filters select {
            padding: 0.5rem 1rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: white;
            color: #2c3e50;
            font-size: 0.9rem;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .kanban-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            min-height: 600px;
        }

        .kanban-column {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
        }

        .column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0 1rem 0;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 1rem;
        }

        .column-header h3 {
            color: #2c3e50;
            font-size: 1.1rem;
            margin: 0;
        }

        .task-count {
            background: #667eea;
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .column-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            min-height: 400px;
            overflow-y: auto;
        }

        .kanban-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: grab;
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
            position: relative;
        }

        .kanban-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .kanban-card.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .card-priority {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .card-priority.high {
            background: #e74c3c;
        }

        .card-priority.medium {
            background: #f39c12;
        }

        .card-priority.low {
            background: #27ae60;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .kanban-card h4 {
            color: #2c3e50;
            font-size: 1rem;
            margin: 0;
            flex: 1;
        }

        .card-actions {
            display: flex;
            gap: 0.3rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .kanban-card:hover .card-actions {
            opacity: 1;
        }

        .btn-action {
            width: 24px;
            height: 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            transition: all 0.2s ease;
        }

        .btn-action.complete {
            background: #27ae60;
            color: white;
        }

        .btn-action.edit {
            background: #3498db;
            color: white;
        }

        .btn-action.delete {
            background: #e74c3c;
            color: white;
        }

        .btn-action:hover {
            transform: scale(1.1);
        }

        .kanban-card p {
            color: #6c757d;
            font-size: 0.9rem;
            margin: 0.5rem 0;
            line-height: 1.4;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 0.5rem;
            border-top: 1px solid #e9ecef;
            font-size: 0.8rem;
        }

        .card-date {
            color: #6c757d;
        }

        .card-category {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .add-task-btn {
            width: 100%;
            padding: 0.8rem;
            border: 2px dashed #d1d5db;
            background: transparent;
            color: #6c757d;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .add-task-btn:hover {
            border-color: #667eea;
            color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        /* ========== RESPONSIVE KANBAN ========== */
        @media (max-width: 1024px) {
            .kanban-board {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .kanban-board {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .kanban-controls {
                flex-direction: column;
                align-items: stretch;
            }
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 0.5rem;
            margin-left: 2.5rem;
        }

        .typing-indicator span {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #adb5bd;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            40% {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                Portal do Aluno
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <span>Jo√£o Silva</span>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    Sair
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>Menu Principal</h3>
            <nav>
                <div class="menu-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-home"></i>
                    <span>In√≠cio</span>
                </div>
                <div class="menu-item" onclick="showSection('chat')">
                    <i class="fas fa-comments"></i>
                    <span>Chat com Coordenadores</span>
                </div>
                <div class="menu-item" onclick="showSection('kanban')">
                    <i class="fas fa-tasks"></i>
                    <span>Minhas Tarefas</span>
                </div>
                <div class="menu-item" onclick="showSection('academic')">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Informa√ß√µes Acad√™micas</span>
                </div>
                <div class="menu-item" onclick="showSection('services')">
                    <i class="fas fa-cog"></i>
                    <span>Servi√ßos</span>
                </div>
                <div class="menu-item" onclick="showSection('support')">
                    <i class="fas fa-question-circle"></i>
                    <span>Suporte</span>
                </div>
            </nav>

            <div class="status-indicator">
                <i class="fas fa-circle"></i>
                <span>Sistema Online</span>
            </div>
        </aside>

        <!-- Content Area -->
        <main class="content-area">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2>Bem-vindo, Jo√£o! üëã</h2>
                    <p>Aqui voc√™ pode acessar todos os servi√ßos e se comunicar com os coordenadores.</p>
                </div>

                <div class="quick-actions">
                    <div class="action-card" onclick="showSection('chat')">
                        <i class="fas fa-comments"></i>
                        <h3>Chat R√°pido</h3>
                        <p>Tire suas d√∫vidas com nossos coordenadores</p>
                    </div>
                    <div class="action-card" onclick="showSection('academic')">
                        <i class="fas fa-graduation-cap"></i>
                        <h3>Minha Situa√ß√£o</h3>
                        <p>Consulte informa√ß√µes acad√™micas</p>
                    </div>
                    <div class="action-card" onclick="showSection('services')">
                        <i class="fas fa-file-alt"></i>
                        <h3>Solicita√ß√µes</h3>
                        <p>Documentos e processos administrativos</p>
                    </div>
                </div>

                <div class="info-cards">
                    <div class="info-card">
                        <h4><i class="fas fa-clock"></i> √öltimas Atividades</h4>
                        <ul class="info-list">
                            <li>
                                <span>Chat com coordena√ß√£o acad√™mica</span>
                                <small>2 horas atr√°s</small>
                            </li>
                            <li>
                                <span>Solicita√ß√£o de hist√≥rico</span>
                                <small>Ontem</small>
                            </li>
                            <li>
                                <span>Mensagem da secretaria</span>
                                <small>2 dias atr√°s</small>
                            </li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h4><i class="fas fa-bell"></i> Notifica√ß√µes</h4>
                        <ul class="info-list">
                            <li>
                                <span>Per√≠odo de matr√≠cula aberto</span>
                                <small>Novo</small>
                            </li>
                            <li>
                                <span>Resposta do coordenador</span>
                                <small>1 hora atr√°s</small>
                            </li>
                            <li>
                                <span>Documento dispon√≠vel</span>
                                <small>3 horas atr√°s</small>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Chat Section -->
            <section id="chat" class="content-section">
                <div class="section-header">
                    <h2>Chat com Coordenadores</h2>
                    <p>Escolha a categoria e tire suas d√∫vidas diretamente com nossos especialistas.</p>
                </div>

                <div class="chat-container">
                    <div class="chat-sidebar">
                        <div class="chat-sidebar-header">
                            <h4>Categorias de Atendimento</h4>
                            <button class="btn btn-primary" onclick="openNewChatModal()" style="margin-top: 0.5rem; width: 100%; padding: 0.5rem; border: none; background: #667eea; color: white; border-radius: 8px; cursor: pointer; font-size: 0.8rem;">
                                <i class="fas fa-plus"></i> Novo Chat
                            </button>
                        </div>
                        <div class="chat-categories">
                            <div class="chat-category active" onclick="selectCategory('academic')">
                                <div class="category-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="category-info">
                                    <h4>Suporte Acad√™mico</h4>
                                    <p>Maria Silva - Coordenadora</p>
                                    <div class="coordinator-status">
                                        <div class="status-dot online"></div>
                                        <span>Online</span>
                                    </div>
                                </div>
                            </div>

                            <div class="chat-category" onclick="selectCategory('administrative')">
                                <div class="category-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="category-info">
                                    <h4>Processos Administrativos</h4>
                                    <p>Jo√£o Santos - Coordenador</p>
                                    <div class="coordinator-status">
                                        <div class="status-dot online"></div>
                                        <span>Online</span>
                                    </div>
                                </div>
                            </div>

                            <div class="chat-category" onclick="selectCategory('financial')">
                                <div class="category-icon">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                                <div class="category-info">
                                    <h4>Quest√µes Financeiras</h4>
                                    <p>Carlos Lima - Coordenador</p>
                                    <div class="coordinator-status">
                                        <div class="status-dot away"></div>
                                        <span>Ausente</span>
                                    </div>
                                </div>
                            </div>

                            <div class="chat-category" onclick="selectCategory('technical')">
                                <div class="category-icon">
                                    <i class="fas fa-cog"></i>
                                </div>
                                <div class="category-info">
                                    <h4>Suporte T√©cnico</h4>
                                    <p>Ana Costa - Coordenadora</p>
                                    <div class="coordinator-status">
                                        <div class="status-dot online"></div>
                                        <span>Online</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="chat-main">
                        <div class="chat-header">
                            <div class="chat-contact-info">
                                <div class="contact-avatar">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="contact-details">
                                    <h4>Maria Silva - Suporte Acad√™mico</h4>
                                    <div class="contact-status">
                                        <i class="fas fa-circle" style="color: #27ae60; font-size: 0.6rem;"></i>
                                        Online - Tempo m√©dio de resposta: 2 min
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chat-messages" id="chatMessages">
                            <div class="message received">
                                <div class="message-avatar">
                                    MS
                                </div>
                                <div class="message-content">
                                    <div class="message-bubble">
                                        Ol√° Jo√£o! Bem-vindo ao suporte acad√™mico da UniSync. Como posso ajud√°-lo hoje?
                                    </div>
                                    <div class="message-time">14:30</div>
                                </div>
                            </div>
                        </div>

                        <div class="chat-input-container">
                            <div class="chat-input">
                                <input type="text" id="messageInput" placeholder="Digite sua mensagem..." onkeypress="handleEnterKey(event)">
                                <button class="send-btn" onclick="sendMessage()">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Kanban Section -->
            <section id="kanban" class="content-section">
                <div class="section-header">
                    <h2>Minhas Tarefas Acad√™micas</h2>
                    <p>Organize e acompanhe suas atividades, trabalhos e estudos de forma eficiente.</p>
                </div>

                <div class="kanban-controls">
                    <button class="btn btn-primary" onclick="openAddTaskModal()">
                        <i class="fas fa-plus"></i> Nova Tarefa
                    </button>
                    <div class="kanban-filters">
                        <select id="taskFilter" onchange="filterTasks()">
                            <option value="all">Todas as Tarefas</option>
                            <option value="academic">Acad√™micas</option>
                            <option value="personal">Pessoais</option>
                            <option value="projects">Projetos</option>
                        </select>
                    </div>
                </div>

                <div class="kanban-board">
                    <div class="kanban-column" data-status="todo">
                        <div class="column-header">
                            <h3>üìù A Fazer</h3>
                            <span class="task-count">0</span>
                        </div>
                        <div class="column-content" id="todo-column">
                            <!-- Tarefas ser√£o adicionadas aqui -->
                        </div>
                        <button class="add-task-btn" onclick="openAddTaskModal('todo')">
                            <i class="fas fa-plus"></i> Adicionar Tarefa
                        </button>
                    </div>

                    <div class="kanban-column" data-status="doing">
                        <div class="column-header">
                            <h3>‚è≥ Em Progresso</h3>
                            <span class="task-count">0</span>
                        </div>
                        <div class="column-content" id="doing-column">
                            <!-- Tarefas ser√£o adicionadas aqui -->
                        </div>
                        <button class="add-task-btn" onclick="openAddTaskModal('doing')">
                            <i class="fas fa-plus"></i> Adicionar Tarefa
                        </button>
                    </div>

                    <div class="kanban-column" data-status="review">
                        <div class="column-header">
                            <h3>üîç Em Revis√£o</h3>
                            <span class="task-count">0</span>
                        </div>
                        <div class="column-content" id="review-column">
                            <!-- Tarefas ser√£o adicionadas aqui -->
                        </div>
                        <button class="add-task-btn" onclick="openAddTaskModal('review')">
                            <i class="fas fa-plus"></i> Adicionar Tarefa
                        </button>
                    </div>

                    <div class="kanban-column" data-status="done">
                        <div class="column-header">
                            <h3>‚úÖ Conclu√≠do</h3>
                            <span class="task-count">0</span>
                        </div>
                        <div class="column-content" id="done-column">
                            <!-- Tarefas ser√£o adicionadas aqui -->
                        </div>
                        <button class="add-task-btn" onclick="openAddTaskModal('done')">
                            <i class="fas fa-plus"></i> Adicionar Tarefa
                        </button>
                    </div>
                </div>
            </section>

            <!-- Academic Section -->
            <section id="academic" class="content-section">
                <div class="section-header">
                    <h2>Informa√ß√µes Acad√™micas</h2>
                    <p>Consulte sua situa√ß√£o acad√™mica e hist√≥rico.</p>
                </div>

                <div class="info-cards">
                    <div class="info-card">
                        <h4><i class="fas fa-user-graduate"></i> Dados Acad√™micos</h4>
                        <ul class="info-list">
                            <li><span>Curso:</span> <strong>Engenharia de Software</strong></li>
                            <li><span>Per√≠odo:</span> <strong>5¬∫ Semestre</strong></li>
                            <li><span>Situa√ß√£o:</span> <strong>Ativo</strong></li>
                            <li><span>CR:</span> <strong>8.5</strong></li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h4><i class="fas fa-calendar"></i> Pr√≥ximos Eventos</h4>
                        <ul class="info-list">
                            <li><span>Matr√≠cula 2024.1</span> <small>15/12 - 20/12</small></li>
                            <li><span>Prova Final P3</span> <small>10/12</small></li>
                            <li><span>Resultado Final</span> <small>22/12</small></li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h4><i class="fas fa-book"></i> Disciplinas Atuais</h4>
                        <ul class="info-list">
                            <li><span>Algoritmos Avan√ßados</span> <strong>A</strong></li>
                            <li><span>Banco de Dados</span> <strong>B+</strong></li>
                            <li><span>Engenharia de Software</span> <strong>A-</strong></li>
                            <li><span>Redes de Computadores</span> <strong>B</strong></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Services Section -->
            <section id="services" class="content-section">
                <div class="section-header">
                    <h2>Servi√ßos e Solicita√ß√µes</h2>
                    <p>Solicite documentos e acompanhe seus processos.</p>
                </div>

                <div class="quick-actions">
                    <div class="action-card">
                        <i class="fas fa-file-alt"></i>
                        <h3>Hist√≥rico Escolar</h3>
                        <p>Solicitar hist√≥rico completo</p>
                    </div>
                    <div class="action-card">
                        <i class="fas fa-certificate"></i>
                        <h3>Declara√ß√µes</h3>
                        <p>Declara√ß√£o de matr√≠cula e outros</p>
                    </div>
                    <div class="action-card">
                        <i class="fas fa-clock"></i>
                        <h3>Hor√°rios</h3>
                        <p>Consultar grade de hor√°rios</p>
                    </div>
                </div>

                <div class="info-card">
                    <h4><i class="fas fa-list"></i> Solicita√ß√µes em Andamento</h4>
                    <ul class="info-list">
                        <li>
                            <span>Hist√≥rico Escolar Completo</span>
                            <small style="color: #f39c12;">Em processamento</small>
                        </li>
                        <li>
                            <span>Declara√ß√£o de Matr√≠cula</span>
                            <small style="color: #27ae60;">Conclu√≠do</small>
                        </li>
                    </ul>
                </div>
            </section>

            <!-- Support Section -->
            <section id="support" class="content-section">
                <div class="section-header">
                    <h2>Central de Suporte</h2>
                    <p>Precisa de ajuda? Estamos aqui para voc√™!</p>
                </div>

                <div class="quick-actions">
                    <div class="action-card" onclick="showSection('chat')">
                        <i class="fas fa-headset"></i>
                        <h3>Chat ao Vivo</h3>
                        <p>Fale com um coordenador agora</p>
                    </div>
                    <div class="action-card">
                        <i class="fas fa-phone"></i>
                        <h3>Telefone</h3>
                        <p>(11) 1234-5678</p>
                    </div>
                    <div class="action-card">
                        <i class="fas fa-envelope"></i>
                        <h3>Email</h3>
                        <p>suporte@unisync.edu.br</p>
                    </div>
                </div>

                <div class="info-card">
                    <h4><i class="fas fa-question-circle"></i> Perguntas Frequentes</h4>
                    <ul class="info-list">
                        <li><span>Como solicitar hist√≥rico escolar?</span></li>
                        <li><span>Quando √© o per√≠odo de matr√≠cula?</span></li>
                        <li><span>Como alterar minha senha?</span></li>
                        <li><span>Onde consulto minhas notas?</span></li>
                    </ul>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal para Criar Novo Chat -->
    <div id="newChatModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);">
        <div class="modal-content" style="position: relative; background: white; margin: 5% auto; padding: 0; width: 90%; max-width: 500px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
            <div class="modal-header" style="padding: 1.5rem; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0; color: #2c3e50;">Criar Novo Chat</h3>
                <button onclick="closeNewChatModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6c757d;">&times;</button>
            </div>
            <div class="modal-body" style="padding: 1.5rem;">
                <form id="newChatForm">
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">T√≠tulo do Chat:</label>
                        <input type="text" id="chatTitle" required style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;" placeholder="Ex: D√∫vida sobre disciplinas">
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Categoria:</label>
                        <select id="chatCategory" required style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;">
                            <option value="">Selecione uma categoria</option>
                            <option value="academic">Suporte Acad√™mico</option>
                            <option value="administrative">Processos Administrativos</option>
                            <option value="financial">Quest√µes Financeiras</option>
                            <option value="technical">Suporte T√©cnico</option>
                            <option value="general">Geral</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Prioridade:</label>
                        <select id="chatPriority" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;">
                            <option value="low">Baixa</option>
                            <option value="medium" selected>M√©dia</option>
                            <option value="high">Alta</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Descri√ß√£o/Mensagem Inicial:</label>
                        <textarea id="chatDescription" rows="4" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem; resize: vertical;" placeholder="Descreva sua d√∫vida ou solicita√ß√£o..."></textarea>
                    </div>
                    <div class="form-actions" style="display: flex; gap: 1rem; justify-content: flex-end;">
                        <button type="button" onclick="closeNewChatModal()" style="padding: 0.8rem 1.5rem; border: 1px solid #6c757d; background: white; color: #6c757d; border-radius: 8px; cursor: pointer;">Cancelar</button>
                        <button type="submit" style="padding: 0.8rem 1.5rem; border: none; background: #667eea; color: white; border-radius: 8px; cursor: pointer;">Criar Chat</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar/Editar Tarefa -->
    <div id="taskModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);">
        <div class="modal-content" style="position: relative; background: white; margin: 5% auto; padding: 0; width: 90%; max-width: 500px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
            <div class="modal-header" style="padding: 1.5rem; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center;">
                <h3 id="taskModalTitle" style="margin: 0; color: #2c3e50;">Nova Tarefa</h3>
                <button onclick="closeTaskModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6c757d;">&times;</button>
            </div>
            <div class="modal-body" style="padding: 1.5rem;">
                <form id="taskForm">
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">T√≠tulo da Tarefa:</label>
                        <input type="text" id="taskTitle" required style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;" placeholder="Ex: Estudar para prova de Matem√°tica">
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Descri√ß√£o:</label>
                        <textarea id="taskDescription" rows="3" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem; resize: vertical;" placeholder="Detalhe sua tarefa (opcional)"></textarea>
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Categoria:</label>
                        <select id="taskCategory" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;">
                            <option value="academic">üìö Acad√™mica</option>
                            <option value="personal">üë§ Pessoal</option>
                            <option value="projects">üíº Projeto</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Prioridade:</label>
                        <select id="taskPriority" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;">
                            <option value="low">üü¢ Baixa</option>
                            <option value="medium" selected>üü° M√©dia</option>
                            <option value="high">üî¥ Alta</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Data de Vencimento:</label>
                        <input type="date" id="taskDate" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;">
                    </div>
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Status:</label>
                        <select id="taskStatus" style="width: 100%; padding: 0.8rem; border: 1px solid #e9ecef; border-radius: 8px; font-size: 0.9rem;">
                            <option value="todo">üìù A Fazer</option>
                            <option value="doing">‚è≥ Em Progresso</option>
                            <option value="review">üîç Em Revis√£o</option>
                            <option value="done">‚úÖ Conclu√≠do</option>
                        </select>
                    </div>
                    <div class="form-actions" style="display: flex; gap: 1rem; justify-content: flex-end;">
                        <button type="button" onclick="closeTaskModal()" style="padding: 0.8rem 1.5rem; border: 1px solid #6c757d; background: white; color: #6c757d; border-radius: 8px; cursor: pointer;">Cancelar</button>
                        <button type="submit" style="padding: 0.8rem 1.5rem; border: none; background: #667eea; color: white; border-radius: 8px; cursor: pointer;">Salvar Tarefa</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="shared-chat.js"></script>
    <script>
        // Vari√°veis globais
        let currentCategory = 'academic';
        let studentId = 'student_' + Date.now();

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar se est√° logado como aluno
            const userProfile = sessionStorage.getItem('userProfile');
            if (userProfile !== 'student') {
                window.location.href = 'login.html';
                return;
            }

            // Inicializar chat
            initializeStudentChat();
            
            // Aguardar chat manager estar dispon√≠vel e restaurar estado
            const waitForChatManager = setInterval(() => {
                if (window.chatManager && window.chatManager.isOnline()) {
                    clearInterval(waitForChatManager);
                    
                    // Restaurar estado do chat ap√≥s conex√£o
                    setTimeout(() => {
                        window.restoreChatState();
                    }, 1000);
                }
            }, 500);
            
            // Carregar mensagens em tempo real
            loadRealTimeMessages();
        });

        // Navega√ß√£o entre se√ß√µes
        function showSection(sectionId) {
            // Remover active de todos os itens do menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // Remover active de todas as se√ß√µes
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // Adicionar active ao item clicado
            event.currentTarget.classList.add('active');

            // Mostrar se√ß√£o correspondente
            document.getElementById(sectionId).classList.add('active');

            // Se for a se√ß√£o de chat, carregar chats din√¢micos
            if (sectionId === 'chat') {
                setTimeout(() => {
                    loadDynamicChats();
                }, 100);
            }
        }

        // Selecionar categoria de chat
        function selectCategory(category) {
            // Remover active de todas as categorias
            document.querySelectorAll('.chat-category').forEach(cat => {
                cat.classList.remove('active');
            });

            // Adicionar active √† categoria selecionada
            event.currentTarget.classList.add('active');

            // Definir categoria atual no chat manager
            if (window.chatManager) {
                window.chatManager.setCurrentCategory(category);
            }

            currentCategory = category;
            
            // Carregar mensagens persistidas da categoria
            if (window.loadPersistedMessages) {
                window.loadPersistedMessages(category);
            } else {
                // Fallback para m√©todo antigo
                loadCategoryChat(category);
            }
        }

        // Carregar chat da categoria
        function loadCategoryChat(category) {
            const coordinators = {
                academic: { name: 'Maria Silva', icon: 'fa-graduation-cap', title: 'Suporte Acad√™mico' },
                administrative: { name: 'Jo√£o Santos', icon: 'fa-file-alt', title: 'Processos Administrativos' },
                financial: { name: 'Carlos Lima', icon: 'fa-dollar-sign', title: 'Quest√µes Financeiras' },
                technical: { name: 'Ana Costa', icon: 'fa-cog', title: 'Suporte T√©cnico' }
            };

            const coord = coordinators[category];
            if (!coord) return;

            // Atualizar header do chat
            document.querySelector('.contact-avatar i').className = `fas ${coord.icon}`;
            document.querySelector('.contact-details h4').textContent = `${coord.name} - ${coord.title}`;

            // Limpar mensagens e carregar do localStorage
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';

            // Mensagem de boas-vindas
            addMessage('received', `Ol√°! Sou ${coord.name}, ${coord.title.toLowerCase()}. Como posso ajud√°-lo hoje?`, getCurrentTime());

            // Carregar mensagens salvas
            loadSavedMessages(category);
        }

        // Enviar mensagem
        function sendMessage() {
            const input = document.getElementById('messageInput');
            if (!input || !window.chatManager) return;
            
            const message = input.value.trim();
            if (!message) return;
            
            // Enviar atrav√©s do chat manager (real-time)
            const success = window.chatManager.sendMessage(currentCategory, message);
            
            if (success) {
                input.value = '';
                console.log('Mensagem enviada pelo aluno:', message);
            }
        }

        // Adicionar mensagem √† interface
        function addMessage(type, message, time) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;

            if (type === 'received') {
                messageDiv.innerHTML = `
                    <div class="message-avatar">
                        ${getCoordinatorInitials(currentCategory)}
                    </div>
                    <div class="message-content">
                        <div class="message-bubble">${message}</div>
                        <div class="message-time">${time}</div>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-content">
                        <div class="message-bubble">${message}</div>
                        <div class="message-time">${time}</div>
                    </div>
                `;
            }

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Obter iniciais do coordenador
        function getCoordinatorInitials(category) {
            const initials = {
                academic: 'MS',
                administrative: 'JS',
                financial: 'CL',
                technical: 'AC'
            };
            return initials[category] || 'CO';
        }

        // Gerar resposta do coordenador baseada na mensagem
        function generateCoordinatorResponse(message) {
            const responses = {
                default: [
                    'Entendi sua d√∫vida. Vou te ajudar com isso.',
                    'Perfeito! Deixe-me verificar essas informa√ß√µes para voc√™.',
                    'Essa √© uma √≥tima pergunta. Vou buscar os detalhes.',
                    'Claro! Posso te orientar sobre esse processo.',
                    'Vou verificar seu caso espec√≠fico e te responder em instantes.'
                ],
                matricula: [
                    'O per√≠odo de matr√≠cula ser√° de 15 a 20 de dezembro. Voc√™ receber√° as instru√ß√µes por email.',
                    'Para a matr√≠cula, acesse o portal acad√™mico na data informada e siga o passo a passo.',
                    'Sua prioridade de matr√≠cula √© baseada no seu CR atual. Voc√™ ter√° prefer√™ncia nas disciplinas.'
                ],
                historico: [
                    'Voc√™ pode solicitar seu hist√≥rico escolar pelo portal. O processamento leva at√© 5 dias √∫teis.',
                    'Para hist√≥rico urgente, compare√ßa na secretaria com documento de identidade.',
                    'O hist√≥rico digital estar√° dispon√≠vel em sua √°rea do aluno em at√© 3 dias √∫teis.'
                ],
                notas: [
                    'Suas notas s√£o atualizadas automaticamente ap√≥s o lan√ßamento pelos professores.',
                    'Para contestar uma nota, voc√™ tem at√© 5 dias ap√≥s a publica√ß√£o.',
                    'Verifique na √°rea do aluno > Boletim para ver suas notas atualizadas.'
                ]
            };

            // Detectar palavra-chave na mensagem
            const msgLower = message.toLowerCase();
            if (msgLower.includes('matr√≠cula') || msgLower.includes('matricula')) {
                return responses.matricula[Math.floor(Math.random() * responses.matricula.length)];
            }
            if (msgLower.includes('hist√≥rico') || msgLower.includes('historico')) {
                return responses.historico[Math.floor(Math.random() * responses.historico.length)];
            }
            if (msgLower.includes('nota') || msgLower.includes('prova')) {
                return responses.notas[Math.floor(Math.random() * responses.notas.length)];
            }

            return responses.default[Math.floor(Math.random() * responses.default.length)];
        }

        // Mostrar indicador de digita√ß√£o
        function showTypingIndicator() {
            const messagesContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = '<span></span><span></span><span></span>';
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Esconder indicador de digita√ß√£o
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Salvar mensagem no localStorage
        function saveMessage(category, messageData) {
            const key = `chat_${category}`;
            let messages = JSON.parse(localStorage.getItem(key) || '[]');
            messages.push(messageData);
            
            // Remover limite - permitir mensagens ilimitadas
            // Coment√°rio: Limite removido para permitir hist√≥rico completo
            // Se houver problemas de performance, descomente a linha abaixo:
            // if (messages.length > 500) messages = messages.slice(-500);
            
            localStorage.setItem(key, JSON.stringify(messages));
        }

        // Fun√ß√£o para limpar mensagens antigas (opcional)
        function clearOldMessages(category = null) {
            if (category) {
                localStorage.removeItem(`chat_${category}`);
                console.log(`Mensagens da categoria ${category} removidas`);
            } else {
                // Limpar todas as mensagens
                const keys = Object.keys(localStorage).filter(key => key.startsWith('chat_'));
                keys.forEach(key => localStorage.removeItem(key));
                console.log('Todas as mensagens foram removidas');
            }
            
            // Recarregar mensagens na interface
            if (currentCategory) {
                loadCategoryChat(currentCategory);
            }
        }

        // Carregar mensagens salvas
        function loadSavedMessages(category) {
            const key = `chat_${category}`;
            const messages = JSON.parse(localStorage.getItem(key) || '[]');
            
            messages.forEach(msg => {
                const time = new Date(msg.timestamp).toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                addMessage(msg.type, msg.message, time);
            });
        }

        // Carregar mensagens em tempo real (simular)
        function loadRealTimeMessages() {
            setInterval(() => {
                // Verificar se h√° novas mensagens dos coordenadores
                // Esta fun√ß√£o seria conectada a um backend real
            }, 5000);
        }

        // Obter hor√°rio atual
        function getCurrentTime() {
            return new Date().toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Manipular Enter no input
        function handleEnterKey(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Inicializar chat do aluno
        function initializeStudentChat() {
            // Definir categoria inicial
            loadCategoryChat('academic');
        }

        // Logout
        function logout() {
            sessionStorage.removeItem('userProfile');
            sessionStorage.removeItem('loginTime');
            window.location.href = 'login.html';
        }

        // Navega√ß√£o do menu por par√¢metros
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function() {
                const section = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                showSection(section);
            });
        });

        // Fun√ß√µes para gerenciar cria√ß√£o de chats
        function openNewChatModal() {
            document.getElementById('newChatModal').style.display = 'block';
        }

        function closeNewChatModal() {
            document.getElementById('newChatModal').style.display = 'none';
            document.getElementById('newChatForm').reset();
        }

        // Event listener para o formul√°rio de novo chat
        document.getElementById('newChatForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            console.log('Formul√°rio de novo chat submetido');
            
            if (!window.chatManager) {
                console.error('Chat manager n√£o est√° dispon√≠vel');
                alert('Sistema de chat n√£o est√° conectado');
                return;
            }

            const chatData = {
                title: document.getElementById('chatTitle').value,
                category: document.getElementById('chatCategory').value,
                priority: document.getElementById('chatPriority').value,
                description: document.getElementById('chatDescription').value
            };

            console.log('Dados do chat a serem enviados:', chatData);

            try {
                const newChat = await window.chatManager.createChat(chatData);
                console.log('Resposta da cria√ß√£o do chat:', newChat);
                
                if (newChat) {
                    closeNewChatModal();
                    showNotification('Chat criado com sucesso!');
                    
                    console.log('Recarregando chats din√¢micos...');
                    // Atualizar lista de chats se estiver na se√ß√£o de chat
                    if (document.getElementById('chat').classList.contains('active')) {
                        await loadDynamicChats();
                    }
                } else {
                    console.error('Falha ao criar chat - resposta null');
                }
            } catch (error) {
                console.error('Erro ao criar chat:', error);
                alert('Erro ao criar chat. Tente novamente.');
            }
        });

        // Fun√ß√£o para mostrar notifica√ß√£o
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-size: 0.9rem;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 3000);
        }

        // Fun√ß√£o para carregar chats din√¢micos
        async function loadDynamicChats() {
            if (!window.chatManager) return;

            try {
                const chats = await window.chatManager.loadChats();
                console.log('Chats carregados:', chats);
                
                // Atualizar interface com os chats din√¢micos
                updateChatSidebar(chats);
                
            } catch (error) {
                console.error('Erro ao carregar chats:', error);
            }
        }

        // Atualizar sidebar com chats din√¢micos
        function updateChatSidebar(chats) {
            const chatCategories = document.querySelector('.chat-categories');
            if (!chatCategories) return;

            // Remover chats din√¢micos existentes (manter apenas os est√°ticos)
            const dynamicChats = chatCategories.querySelectorAll('.chat-category[data-dynamic="true"]');
            dynamicChats.forEach(chat => chat.remove());

            // Adicionar novos chats din√¢micos
            chats.forEach(chat => {
                const chatElement = document.createElement('div');
                chatElement.className = 'chat-category';
                chatElement.setAttribute('data-dynamic', 'true');
                chatElement.setAttribute('data-chat-id', chat.id);
                
                const priorityIcon = chat.priority === 'high' ? 'üî¥' : chat.priority === 'medium' ? 'üü°' : 'üü¢';
                const categoryIcon = getCategoryIcon(chat.category);
                
                // Verificar se o chat foi criado pelo usu√°rio atual
                const canDelete = chat.createdByType === window.chatManager?.userType && 
                                 chat.createdBy === window.chatManager?.userName;
                
                chatElement.innerHTML = `
                    <div class="category-icon">
                        <i class="fas ${categoryIcon}"></i>
                    </div>
                    <div class="category-info">
                        <h4>${chat.title} ${priorityIcon}</h4>
                        <p>Criado por ${chat.createdBy}</p>
                        <div class="coordinator-status">
                            <div class="status-dot online"></div>
                            <span>${formatTimeAgo(chat.createdAt)}</span>
                        </div>
                    </div>
                    ${canDelete ? `
                        <div class="chat-actions" style="position: absolute; top: 5px; right: 5px;">
                            <button onclick="deleteChatConfirm(${chat.id}, '${chat.title}')" style="background: #e74c3c; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; font-size: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center;" title="Excluir chat">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    ` : ''}
                `;
                
                // Adicionar estilo de posi√ß√£o relativa para permitir posicionamento absoluto do bot√£o
                chatElement.style.position = 'relative';
                
                chatElement.addEventListener('click', (e) => {
                    // Prevenir clique se clicar no bot√£o de exclus√£o
                    if (e.target.closest('.chat-actions')) return;
                    selectDynamicChat(chat);
                });
                
                chatCategories.appendChild(chatElement);
            });
        }

        // Selecionar chat din√¢mico
        function selectDynamicChat(chat) {
            // Remover active de todas as categorias
            document.querySelectorAll('.chat-category').forEach(cat => {
                cat.classList.remove('active');
            });

            // Adicionar active ao chat selecionado
            const chatElement = document.querySelector(`[data-chat-id="${chat.id}"]`);
            if (chatElement) {
                chatElement.classList.add('active');
            }

            currentCategory = chat.category;
            loadDynamicChatConversation(chat);
        }

        // Carregar conversa do chat din√¢mico
        function loadDynamicChatConversation(chat) {
            // Atualizar header do chat
            const contactInfo = document.querySelector('.chat-contact-info');
            if (contactInfo) {
                const categoryIcon = getCategoryIcon(chat.category);
                contactInfo.innerHTML = `
                    <div class="contact-avatar">
                        <i class="fas ${categoryIcon}"></i>
                    </div>
                    <div class="contact-details">
                        <h4>${chat.title}</h4>
                        <div class="contact-status">
                            <i class="fas fa-circle" style="color: #27ae60; font-size: 0.6rem;"></i>
                            Chat criado por ${chat.createdBy} - ${chat.priority} prioridade
                        </div>
                    </div>
                `;
            }

            // Limpar mensagens e carregar do chat
            const messagesContainer = document.getElementById('chatMessages');
            if (messagesContainer) {
                messagesContainer.innerHTML = `
                    <div class="message received">
                        <div class="message-avatar">
                            ${getCoordinatorInitials(chat.category)}
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                ${chat.description || 'Chat iniciado'}
                            </div>
                            <div class="message-time">${formatTimeAgo(chat.createdAt)}</div>
                        </div>
                    </div>
                `;
            }

            // Atualizar categoria atual do chat manager
            if (window.chatManager) {
                window.chatManager.setCurrentCategory(chat.category);
            }
        }

        // Obter √≠cone da categoria
        function getCategoryIcon(category) {
            const icons = {
                academic: 'fa-graduation-cap',
                administrative: 'fa-file-alt',
                financial: 'fa-dollar-sign',
                technical: 'fa-cog',
                general: 'fa-comments'
            };
            return icons[category] || 'fa-comments';
        }

        // Formatar tempo relativo
        function formatTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInMinutes = Math.floor((now - date) / (1000 * 60));
            
            if (diffInMinutes < 1) return 'Agora';
            if (diffInMinutes < 60) return `${diffInMinutes} min atr√°s`;
            if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)} horas atr√°s`;
            return `${Math.floor(diffInMinutes / 1440)} dias atr√°s`;
        }

        // Carregar chats din√¢micos quando a p√°gina carrega
        window.addEventListener('load', loadDynamicChats);

        // Listener para novos chats criados
        window.addEventListener('newChatCreated', function(event) {
            const chat = event.detail;
            console.log('Novo chat detectado:', chat);
            loadDynamicChats();
        });

        // Fun√ß√£o para confirmar exclus√£o de chat
        function deleteChatConfirm(chatId, chatTitle) {
            if (confirm(`Tem certeza que deseja excluir o chat "${chatTitle}"?\n\nEsta a√ß√£o n√£o pode ser desfeita.`)) {
                deleteChat(chatId);
            }
        }

        // Fun√ß√£o para excluir chat
        async function deleteChat(chatId) {
            if (!window.chatManager) {
                alert('Sistema de chat n√£o est√° conectado');
                return;
            }

            try {
                const deleted = await window.chatManager.deleteChat(chatId);
                if (deleted) {
                    showNotification('Chat exclu√≠do com sucesso!');
                    
                    // Recarregar lista de chats
                    await loadDynamicChats();
                    
                    // Se o chat exclu√≠do estava selecionado, voltar para o chat padr√£o
                    const activeChat = document.querySelector('.chat-category[data-dynamic="true"].active');
                    if (!activeChat) {
                        // Selecionar o primeiro chat est√°tico
                        const firstStaticChat = document.querySelector('.chat-category:not([data-dynamic])');
                        if (firstStaticChat) {
                            firstStaticChat.click();
                        }
                    }
                } else {
                    alert('Erro ao excluir chat. Tente novamente.');
                }
            } catch (error) {
                console.error('Erro ao excluir chat:', error);
                alert('Erro ao excluir chat. Tente novamente.');
            }
        }

        // ========== FUN√á√ïES DO KANBAN ==========
        
        // Vari√°veis globais do Kanban
        let studentTasks = JSON.parse(localStorage.getItem('studentTasks')) || [];
        let currentEditingTask = null;

        // Inicializar Kanban
        function initializeKanban() {
            loadTasksFromStorage();
            setupDragAndDrop();
            updateTaskCounts();
        }

        // Carregar tarefas do localStorage
        function loadTasksFromStorage() {
            const tasks = JSON.parse(localStorage.getItem('studentTasks')) || [];
            
            // Limpar colunas
            document.querySelectorAll('.column-content').forEach(column => {
                column.innerHTML = '';
            });
            
            // Adicionar tarefas de exemplo se n√£o houver nenhuma
            if (tasks.length === 0) {
                addExampleTasks();
            } else {
                tasks.forEach(task => {
                    addTaskToColumn(task);
                });
            }
            
            updateTaskCounts();
        }

        // Adicionar tarefas de exemplo
        function addExampleTasks() {
            const exampleTasks = [
                {
                    id: generateTaskId(),
                    title: 'Estudar para Prova de C√°lculo',
                    description: 'Revisar cap√≠tulos 1-5 do livro e resolver exerc√≠cios',
                    category: 'academic',
                    priority: 'high',
                    dueDate: getDateString(3),
                    status: 'todo',
                    createdAt: new Date().toISOString()
                },
                {
                    id: generateTaskId(),
                    title: 'Trabalho de Hist√≥ria',
                    description: 'Pesquisar sobre a Revolu√ß√£o Industrial',
                    category: 'academic',
                    priority: 'medium',
                    dueDate: getDateString(7),
                    status: 'doing',
                    createdAt: new Date().toISOString()
                },
                {
                    id: generateTaskId(),
                    title: 'Projeto de TCC',
                    description: 'Definir tema e orientador',
                    category: 'projects',
                    priority: 'high',
                    dueDate: getDateString(14),
                    status: 'review',
                    createdAt: new Date().toISOString()
                }
            ];
            
            studentTasks = exampleTasks;
            saveTasksToStorage();
            
            exampleTasks.forEach(task => {
                addTaskToColumn(task);
            });
            
            updateTaskCounts();
        }

        // Gerar ID √∫nico para tarefa
        function generateTaskId() {
            return 'task_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // Obter string de data no formato YYYY-MM-DD
        function getDateString(daysFromNow) {
            const date = new Date();
            date.setDate(date.getDate() + daysFromNow);
            return date.toISOString().split('T')[0];
        }

        // Salvar tarefas no localStorage
        function saveTasksToStorage() {
            localStorage.setItem('studentTasks', JSON.stringify(studentTasks));
        }

        // Adicionar tarefa √† coluna
        function addTaskToColumn(task) {
            const column = document.getElementById(`${task.status}-column`);
            if (!column) return;
            
            const taskCard = createTaskCard(task);
            column.appendChild(taskCard);
        }

        // Criar card de tarefa
        function createTaskCard(task) {
            const taskCard = document.createElement('div');
            taskCard.className = 'kanban-card';
            taskCard.draggable = true;
            taskCard.setAttribute('data-task-id', task.id);
            
            const categoryEmoji = task.category === 'academic' ? 'üìö' : task.category === 'projects' ? 'üíº' : 'üë§';
            const dueDate = task.dueDate ? new Date(task.dueDate).toLocaleDateString('pt-BR') : 'Sem prazo';
            
            taskCard.innerHTML = `
                <div class="card-priority ${task.priority}"></div>
                <div class="card-header">
                    <h4>${task.title}</h4>
                    <div class="card-actions">
                        <button class="btn-action complete" onclick="completeStudentTask('${task.id}')" title="Marcar como conclu√≠da">
                            <i class="fas fa-check"></i>
                        </button>
                        <button class="btn-action edit" onclick="editStudentTask('${task.id}')" title="Editar tarefa">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-action delete" onclick="deleteStudentTask('${task.id}')" title="Excluir tarefa">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                ${task.description ? `<p>${task.description}</p>` : ''}
                <div class="card-footer">
                    <span class="card-date">${dueDate}</span>
                    <span class="card-category">${categoryEmoji} ${getCategoryName(task.category)}</span>
                </div>
            `;
            
            // Adicionar eventos de drag
            taskCard.addEventListener('dragstart', handleTaskDragStart);
            taskCard.addEventListener('dragend', handleTaskDragEnd);
            
            return taskCard;
        }

        // Obter nome da categoria
        function getCategoryName(category) {
            const categories = {
                academic: 'Acad√™mica',
                personal: 'Pessoal',
                projects: 'Projeto'
            };
            return categories[category] || category;
        }

        // Setup drag and drop
        function setupDragAndDrop() {
            const columns = document.querySelectorAll('.column-content');
            
            columns.forEach(column => {
                column.addEventListener('dragover', handleTaskDragOver);
                column.addEventListener('drop', handleTaskDrop);
            });
        }

        // Manipular in√≠cio do drag
        function handleTaskDragStart(e) {
            this.classList.add('dragging');
            e.dataTransfer.setData('text/plain', this.getAttribute('data-task-id'));
        }

        // Manipular fim do drag
        function handleTaskDragEnd(e) {
            this.classList.remove('dragging');
        }

        // Manipular drag over
        function handleTaskDragOver(e) {
            e.preventDefault();
        }

        // Manipular drop
        function handleTaskDrop(e) {
            e.preventDefault();
            const taskId = e.dataTransfer.getData('text/plain');
            const newStatus = this.parentElement.getAttribute('data-status');
            
            moveTaskToStatus(taskId, newStatus);
        }

        // Mover tarefa para novo status
        function moveTaskToStatus(taskId, newStatus) {
            const taskIndex = studentTasks.findIndex(task => task.id === taskId);
            if (taskIndex === -1) return;
            
            // Atualizar status da tarefa
            studentTasks[taskIndex].status = newStatus;
            if (newStatus === 'done') {
                studentTasks[taskIndex].completedAt = new Date().toISOString();
            }
            
            saveTasksToStorage();
            
            // Recarregar interface
            loadTasksFromStorage();
            
            showNotification(`Tarefa movida para ${getStatusName(newStatus)}!`);
        }

        // Obter nome do status
        function getStatusName(status) {
            const statuses = {
                todo: 'A Fazer',
                doing: 'Em Progresso',
                review: 'Em Revis√£o',
                done: 'Conclu√≠do'
            };
            return statuses[status] || status;
        }

        // Abrir modal de tarefa
        function openAddTaskModal(status = 'todo') {
            currentEditingTask = null;
            document.getElementById('taskModalTitle').textContent = 'Nova Tarefa';
            document.getElementById('taskForm').reset();
            document.getElementById('taskStatus').value = status;
            document.getElementById('taskModal').style.display = 'block';
        }

        // Fechar modal de tarefa
        function closeTaskModal() {
            document.getElementById('taskModal').style.display = 'none';
            document.getElementById('taskForm').reset();
            currentEditingTask = null;
        }

        // Editar tarefa
        function editStudentTask(taskId) {
            const task = studentTasks.find(t => t.id === taskId);
            if (!task) return;
            
            currentEditingTask = task;
            document.getElementById('taskModalTitle').textContent = 'Editar Tarefa';
            document.getElementById('taskTitle').value = task.title;
            document.getElementById('taskDescription').value = task.description || '';
            document.getElementById('taskCategory').value = task.category;
            document.getElementById('taskPriority').value = task.priority;
            document.getElementById('taskDate').value = task.dueDate || '';
            document.getElementById('taskStatus').value = task.status;
            document.getElementById('taskModal').style.display = 'block';
        }

        // Completar tarefa
        function completeStudentTask(taskId) {
            moveTaskToStatus(taskId, 'done');
        }

        // Excluir tarefa
        function deleteStudentTask(taskId) {
            if (!confirm('Tem certeza que deseja excluir esta tarefa?')) return;
            
            const taskIndex = studentTasks.findIndex(task => task.id === taskId);
            if (taskIndex === -1) return;
            
            studentTasks.splice(taskIndex, 1);
            saveTasksToStorage();
            loadTasksFromStorage();
            
            showNotification('Tarefa exclu√≠da com sucesso!');
        }

        // Atualizar contadores de tarefas
        function updateTaskCounts() {
            const statuses = ['todo', 'doing', 'review', 'done'];
            
            statuses.forEach(status => {
                const column = document.querySelector(`[data-status="${status}"]`);
                const count = column ? column.querySelectorAll('.kanban-card').length : 0;
                const countElement = column ? column.querySelector('.task-count') : null;
                
                if (countElement) {
                    countElement.textContent = count;
                }
            });
        }

        // Filtrar tarefas
        function filterTasks() {
            const filter = document.getElementById('taskFilter').value;
            const cards = document.querySelectorAll('.kanban-card');
            
            cards.forEach(card => {
                const taskId = card.getAttribute('data-task-id');
                const task = studentTasks.find(t => t.id === taskId);
                
                if (filter === 'all' || task.category === filter) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
            
            updateTaskCounts();
        }

        // Event listener para formul√°rio de tarefa
        document.addEventListener('DOMContentLoaded', function() {
            const taskForm = document.getElementById('taskForm');
            if (taskForm) {
                taskForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const taskData = {
                        title: document.getElementById('taskTitle').value,
                        description: document.getElementById('taskDescription').value,
                        category: document.getElementById('taskCategory').value,
                        priority: document.getElementById('taskPriority').value,
                        dueDate: document.getElementById('taskDate').value,
                        status: document.getElementById('taskStatus').value
                    };
                    
                    if (currentEditingTask) {
                        // Editar tarefa existente
                        const taskIndex = studentTasks.findIndex(t => t.id === currentEditingTask.id);
                        if (taskIndex !== -1) {
                            studentTasks[taskIndex] = {
                                ...studentTasks[taskIndex],
                                ...taskData,
                                updatedAt: new Date().toISOString()
                            };
                            showNotification('Tarefa atualizada com sucesso!');
                        }
                    } else {
                        // Criar nova tarefa
                        const newTask = {
                            id: generateTaskId(),
                            ...taskData,
                            createdAt: new Date().toISOString()
                        };
                        studentTasks.push(newTask);
                        showNotification('Nova tarefa criada com sucesso!');
                    }
                    
                    saveTasksToStorage();
                    loadTasksFromStorage();
                    closeTaskModal();
                });
            }
            
            // Inicializar Kanban quando a p√°gina carregar
            setTimeout(() => {
                initializeKanban();
            }, 1000);
        });

    </script>
</body>
</html> 